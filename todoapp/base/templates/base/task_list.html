{% extends 'base/main.html' %}
{% load static %}

{% block css %}
{% static 'css/tasks.css' %}
{% endblock css %}

{% block content %}
    <div class="container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <button class="sidebar-button add-team-btn">
                <span class="icon"><a href="{% url "hub" %}">üè†</a></span>
            </button>
            <h2 class="sidebar-title">–ö–æ–º–∞–Ω–¥—ã</h2>
            {% if teams %}
            {% for team in teams %}
            <a href = "{% url "team" team.pk %}">
                <button class="sidebar-button">{{ team.name }}</button>
            </a>
            {% endfor %}
        {% else %}
            <p>No teams found</p>
        {% endif %}
        <a href = "{% url "create_team" %}">
            <button class="sidebar-button add-team-btn">
                <span class="icon">+</span>
            </button>
        </a>
            <button class="sidebar-button settings-btn">
                <span class="icon">‚öôÔ∏è</span>
            </button>
            <button class="sidebar-button user-btn">
                <span class="icon">üë§</span>
            </button>
        </aside>

        <!-- Team Members Panel -->
        <aside class="team-members">
            {% if team %}
            <h2>–£—á–∞—Å—Ç–Ω–∏–∫–∏ –∫–æ–º–∞–Ω–¥—ã: {{ team.name }}</h2>
            {% if team.members.all %}
                {% for member in team.members.all %}
                    <div class="team-member">
                        <div class="member-info">
                            <img src="alice.gif" alt="Alice" class="avatar">
                            <div>
                                {% if member == team.creator %}
                                    <p class="member-name">{{ member.username }} üëë</p>
                                {% else %}
                                    <p class="member-name">{{ member.username }}</p>
                                {% endif %}
                                <p>–£—Ä–æ–≤–µ–Ω—å: 5</p>
                                <a href = "{% url "task_create" %}">
                                <button class="assign-task-btn">–î–∞—Ç—å —Ç–∞—Å–∫</button>
                                </a>
                            </div>
                        </div>
                        <br>
                        <button class="remove-member-btn">–£–±—Ä–∞—Ç—å –∏–∑ –∫–æ–º–∞–Ω–¥—ã</button>
                    </div>
                {% endfor %}
            {% else %}
                <p>–í —ç—Ç–æ–π –∫–æ–º–∞–Ω–¥–µ –ø–æ–∫–∞ –Ω–µ—Ç —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤.</p>
            {% endif %}
        {% else %}
            <p>–ö–æ–º–∞–Ω–¥–∞ –Ω–µ –≤—ã–±—Ä–∞–Ω–∞.</p>
        {% endif %}
        </aside>

        <!-- Main Content (Tasks) -->
        <main class="main-content">
            {% if team %}
                <h1 class="main-title">–ó–∞–¥–∞—á–∏ {{ team.name }}</h1>
            {% endif %}
     
            <div class="tasks">
                {% for task in tasks %}
                <div class="task-card">
                    <div class="task-content">
                        <h3 class="task-title">{{ task.title }}</h3>
                        <p class="task-assigned">–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å: {{ task.user }}</p>
                        
                        {% for reward in task.reward_set.all %}
                            <p class="reward-xp">+{{ reward.xp }}</p>
                        {% endfor %}
                            <div class="task-actions">
                                <button class="edit-btn">‚úèÔ∏è</button>
                                <a href = "{% url 'delete_task' task.id %}">
                                <button class="delete-btn">üóëÔ∏è</button>
                                </a>
                                <button class="check-btn">‚úîÔ∏è</button>
                            </div>
                        </div>
                    </div>

                {% endfor %}
            </div>
        </main>

        <!-- Rewards Panel -->
        <aside class="rewards-panel">
            <h2 class="panel-title">–ù–∞–≥—Ä–∞–¥—ã</h2>
            {% for task in tasks %}
                <div class="reward-card">
                    <h3 class="reward-title">{{ task.title }}</h3>
                    {% for reward in rewards %}
                        {% if reward.task == task %}
                            <p class="reward-xp">+{{ reward.xp }}</p>
                        {% endif %}
                    {% endfor %}
                </div>
            {% endfor %}
        </aside>
    </div>
{% endblock content %}